<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>reveal.js</title>

		<link rel="stylesheet" href="css/reveal.css">
		<!--<link rel="stylesheet" href="css/theme/black.css">-->
        <link rel="stylesheet" href="css/theme/night.css" id="theme">
        <link rel="stylesheet" href="css/main.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
                <section>
                    <h3>Fun with robotics using Perl and LEGO® Mindstorms</h3>
                </section>

                <section data-state="dragonlance">
                    <img src="images/dragonlance_chronicles_legends.jpg">
                    <h4>Story Time</h4>
                    <small>Growing up with Fantasy and Magic</small>
                    <aside class="notes">
                        DragonLance - Chronicles 1 and adventurers new beginnings<br><br>
                        Worlds full of fantastic ideas, like wizardry
                    </aside>
                </section>

                <section>
                    <h4>Why the Story?</h4>
                    <aside class="notes">
                        Coding with Robots is Wizardry<br><br>
                        This trying to do something more with Mindstorms outside of the normal bounds is our new adventure and as youw will see, as with many new adventuers,
                        you can easily find yourself taking the the more complicated path first until you know you way better.
                    </aside>
                </section>

                <section>
                    <h4>What are we doing?</h4>
                    Using a text-based language (Perl) to control Mindstorms with a reasonable degree of usability.
                </section>

                <section data-state="ev3visualloop">
                    <img src="images/ev3visualloop.png">
                    <h4>But first...</h4>
                    <aside class="notes">
                        Using Mindstorms the with provided software/IDE
                    </aside>
                </section>

                <section>(picture needed) PC/Mac or Lighter Version for Tablets</section>

                <section data-state="ev3visualloop">
                    <img src="images/ev3visualloop.png">
                    Scripts built with sequence of blocks.
                </section>

                <section data-state="ev3brick">
                    <img src="images/ev3brick.jpg" width="45%"><br>
                    Released in September 2013
                </section>

                <section>
                    <p>178×128 pixel Monochrome LCD</p>
                    <p>TI Sitara AM1808 (ARM926EJ-S core) @300 MHz Processor</p>
                    <p>64 MB RAM</p>
                    <p>16 MB Flash</p>
                    <p>USB Port</p>
                    <p>SD Card Slot</p>
                </section>

                <section>
                    <h4>Mindstorms with Perl</h4>
                    Looking for our solution...
                </section>

                <section>A lot of <strike>other great solutions</strike> not perl...
                    <p class="fragment"><a href="http://legoengineering.com/platform/labview/" target="_blank">LabVIEW</a> - not Perl</p>
                    <p class="fragment"><a href="http://www.lejos.org/ev3.php" target="_blank">leJOS</a> - not Perl</p>
                    <p class="fragment"><a href="http://www.legoengineering.com/open-roberta/" target="_blank">OpenRoberta</a> - not Perl</p>
                    <p class="fragment"><a href="http://www.legoengineering.com/introducing-ev3-basic/" target="_blank">EV3 Basic</a> - not Perl</p>
                    <aside class="notes">
                        http://www.legoengineering.com/alternative-programming-languages/
                    </aside>
                </section>

                <section>
                    <p class="fragment"><a href="https://scratch.mit.edu/" target="_blank">Scratch</a> - not Perl</p>
                    <p class="fragment"><a href="http://www.legoengineering.com/platform/robolab/" target="_blank">ROBOLAB</a> - not Perl</p>
                    <p class="fragment"><a href="http://www.robotc.net/" target="_blank">RobotC</a> - not Perl. <br><small>Though there is RobotC::Wrapper</small></p>
                </section>

                <section>
                    <h4><a href="http://www.ev3dev.org/" target="_blank">EV3Dev</a></h4>
                    <p>Debian based Linux Distro</p>
                    <p>Boots off the SD Card</p>
                </section>

                <section>
                    (picture of ev3dev on mindstorms screen)
                    <p>We can run whatever language runs on Linux so we have the first part of our solution!</p>
                </section>

                <section data-state="langsev3dev">
                    <img src="images/Programming_Languages_on_ev3dev.png" width="80%">
                </section> 

                <section>
                    <h4>No Perl but...</h4>
                    <p class="fragment">ev3dev-c comes with a Perl module generate with SWIG!</p>
                </section>

                <section>
                    <h4><a href="http://www.swig.org/" target="_blank">SWIG?</a></h4>
                    <p>Simplified Wrapper and Interface Generator</p>
                </section>

                <section>
                    <p>XS = Perl engineers solution for interacting with C</p>
                    <p>SWIG = C engineers solution for interaction with <strike>other languages</strike> Perl</p>
                </section>

                <section>
                    <h4>Basically...</h4>
                    <p>You create .i file the represents the mapping of C to Perl (variables, functions, structs, classes,etc)</p>
                </section>

                <section>
                    <h4>Then...</h4>
                    <p>SWIG generates a shared object file (.so) and a Perl module (.pm)</p>
                </section>

                <section>
                    ev3.pm!
                    <p>Thanks <a href="https://github.com/in4lio/ev3dev-c" target="_blank">ev3dev-c</a></p>
                </section>

                <section>
                    <h4>However...</h4>
                    The EV3 brick isn't the most performant
                    <p class="fragment">So coding in a session on the EV3 Brick isn't ideal</p>
                </section>
                <section>
                    <p>TI Sitara AM1808 (ARM926EJ-S core) @300 MHz Processor</p>
                    <p><a href="http://www.ti.com/lit/er/sprz313h/sprz313h.pdf" target="_blank">Errata Doc was out in 2010</a></p>
                    <p>64 MB RAM</p>
                    <p>16 MB Flash</p>
                </section>
                <section>
                    Yay Docker!
                    <p>https://hub.docker.com/search/?q=ev3dev</p>
                </section>
                <section>
                    Fun with tests and mocks!
                    https://github.com/gaudeon/ev3dev-perl
                    <ul>
                        lib/<br>
                        <ul>
                        ev3.pm<br>
                        ev3.so<br>
                        server.pm
                        </ul>
                        t/<br>
                        <ul>
                            lib/<br>
                            <ul>
                            ev3mock.pm
                            </ul>
                            server.t 
                        </ul>
                    </ul>
                </section>
                <section>
                    Motor Movement
                    <pre><code data-trim data-noescape class="perl">
                        ev3::ev3_init() != -1 || die 'failed to initialized ev3';

                        while ( ev3::ev3_tacho_init() < 1 ) {
                            sleep 1;
                        }

                        my ( $ok, $sn ) = ev3::ev3_search_tacho( 
                            $ev3::LEGO_EV3_M_MOTOR
                        );

                        if ($ok ) {
                            my $speed = 500;
                            ev3::set_tacho_speed_sp( $sn, $speed );

                            ev3::set_tacho_ramp_up_sp( $sn, 0 );
                            ev3::set_tacho_ramp_down_sp( $sn, 0 );

                            ev3::set_tacho_command_inx( 
                                $sn, $ev3::TACHO_RUN_FOREVER 
                            );
                        }

                        ev3::ev3_unint();
                    </code></pre>
                </section>
                <section>
                    Motor Movement - Initialization
                    <pre><code data-trim data-noescape class="perl">
                        ev3::ev3_init() != -1 || die 'failed to initialized ev3';

                        while ( ev3::ev3_tacho_init() < 1 ) {
                            sleep 1;
                        }
                    </code></pre>
                </section>
                <section>
                    Motor Movement - Finding our Motor
                    <pre><code data-trim data-noescape class="perl">
                        my ( $ok, $sn ) = ev3::ev3_search_tacho( 
                            $ev3::LEGO_EV3_M_MOTOR 
                        );
                    </code></pre>
                </section>
                <section>
                    Motor Movement - Moving our Motor
                    <pre><code data-trim data-noescape class="perl">
                        my $speed = 500;
                        ev3::set_tacho_speed_sp( $sn, $speed );

                        ev3::set_tacho_ramp_up_sp( $sn, 0 );
                        ev3::set_tacho_ramp_down_sp( $sn, 0 );

                        ev3::set_tacho_command_inx( 
                            $sn, $ev3::TACHO_RUN_FOREVER
                        );
                    </code></pre>
                </section>
                <section>
                    Motor Movement - Uninitialization
                    <pre><code data-trim data-noescape class="perl">
                        ev3::ev3_unint();
                    </code></pre>
                </section>
                <section>
                    Demo Time!
                </section>
                <section>
                    Useful Tips!
                    <p>"Can't locate loadable object for module ev" likely means code it's on ev3dev or docker container</p>
                    <p>There is some helpful docs to dig through! (links at the end)</p>
                    <p>Battery Power matteries, when your batteries are low your OS gets <strong>really</strong> sluggish</p>
                    <p>Don't forget to run your scripts as root!</p>
                </section>
                <section>
                    What about Perl 6? <span class="fragment">sadface</span>
                </section>
                <section>
                    <p>Adventures with BrickPi3?</p>
                    Still ongoing but here is what I know...
                </section>
                <section>
                    More OS options
                    <ul>
                        EV3Dev - I failed to get it to work (might have been firmware)
                        Raspian for Robots
                    </ul>
                </section>
                <section>
                    Don't pull the SD out of a BrickPi3 while the case is still on.
                    (picture)
                </section>
                <section>
                    Dexter Industries is your friend!
                    <p>awesome support experience</p>
                </section>
                <section>
                    Updating firmware https://github.com/DexterInd/BrickPi3/tree/master/Firmware
                </section>
                <section>
                    There is a c lib on Rasbian for Robots but no SWIG for perl. Building a SWIG to Perl implementation is an interesting experience but...
                </section>
                <section>
                    Interacting with the BrickPi directly can happen by sending some bytes over SPI.
                    And there is even a Perl module to help you. RPi::SPI
                </section>
                <section>
                    Perl 6?
                    <p>Definite possibility</p>
                    <p>Instead of SWIG you could try NativeCall to use the C lib in Perl 6. https://docs.perl6.org/language/nativecall</p>
                    <p>No SPI module but you could still figure out how to interface with it</p> 
                    <ul class="fragment">cheating by looking at RPi::SPI is totally allowed)</ul>
                </section>

                <section>
                    <h4>A bunch of links...</h4>
                </section>

                <section>
                    <img src="images/OpenWest-Hadouken.gif" class="no-border" width="400px">
                    <h4>Travis Chase</h4>
                    <small>Software Engineer and Tech Enthusiast (Believer in Wizardry)</small><br>
                    <small><a href="mailto: gaudeon@cpan.org">gaudeon@cpan.org</a></small><br>
                    <small><a href="http://github.com/gaudeon">github.com/gaudeon</a></small>
                </section>
               
                <!-- Throw away notes --> 

				<section>Intented Audience. Those interested in playing with mindstorms or brickpi with perl 5 / 6. I hope you are interested in hearing about my experience trying this out. Because you really can figure out a lot of this on your own by searching the internet.</section>
                <section>Audience Plays Mindstorms</section>
                <section>Ev3dev on Minstorms</seciton>
				<section>Perl 5 on Mindstorms. ev3dev-c provides a swig</section>
                <section>Perl 6 on Mindstorms. use NativeCall. https://docs.perl6.org/language/nativecall</section>
                <section>BrickPi3 setup</section>
                <section>Tried Ev3dev on BrickPi3 but didn't work so tried Raspbian for Robots</section>
                <section>Raspian for Robots Quality of Life additions (like vim instead of just vi for those that like vi/vim, and using vim as git's core editor)</section>
                <section>Don't pull the SD out of a BrickPi3 while the case is still on</section>
                <section>If BrickPi3 hat isn't working try updating firmware https://github.com/DexterInd/BrickPi3/tree/master/Firmware. Talk about my experience with support from Dexter Industries.</section>
                <section>g++ segmentation fault (program cc1plus). g++ just not working :/. gcc was though and leared you could run c++ code using libstdc++. So installed "sudo aptitude install 'libstdc++6'" with the intent of using gcc. In the process of that other things were updated that lead to g++ to start working!</section>
                <section>learning SWIG. when starting out (and if your c/c++ is rusty like mine) commit to gcc or g++. started small just to learn swig basics then tried to convert BrickPi3.</section>
                <section>Perl 5 on Mindstorms</section>
                <section>As is usually the case when you are blinding going into something you risk trying to the hardest thing first ;)</section>
                <section>Mindstorms Bricks aren't the most speedy of devices (talk about specs) so you might want to write your code tdd style with mocking on something else</section>
                <section>Released in September 2013. 178×128 pixel Monochrome LCD. TI Sitara AM1808 (ARM926EJ-S core) @300 MHz Processor, 64 MB RAM, 16 MB Flash</section>
                <seciont>If that something else isn't the enviroment ev3.pm was compiled under. You will get this error "Can't locate loadable object for module ev". So try something like Docker (this is happy because ev3dev has docker recipes in dockerhub)</section>
                <section>The ev3dev tutorials at www.ev3dev.org/docs/tutorial are helpful - Hardware Tacho-Motor Class was particularly useful</section>
                <section>The ev3dev-c perl examples are helpful.. https://github.com/in4lio/ev3dev-c/tree/master/perl</section>
                <section>The documentation is also helpful.. http://docs.ev3dev.org/projects/lego-linux-drivers/en/ev3dev-jessie/</section>
                <section>Low powered bricks are more sluggish</section>
                <section>cpan is pretty heavy on the brick, try cpanminux. sudo apt-get install cpanminus</section>
                <section>sequence numbers at based on the number identifier that is part of the 'motor' label in /sys/class/tacho-motor. They increment from 0 to 63 as you plug/unplug motors</section>
                <section>don't forget to run your scripts as root!</section>
                <section>Perl 6 on Ev3dev. You might not like the experience. The mindstorms brick just doesn't quite have the horse power needed to run vm based languages. Completely my opinion here but is seems to me as Perl 6 optimization for performance continues then someday I may have the opportunity to reasonably try perl 6 on this device. Just as optimal, though, would be if we got an EV4 :)</section>
                <section>Perl 5 on BrickPi3. how to SWIG BrickPi3.cpp</section>
                <section>SWIG BrickPi3. "sudo aptitude install swig"</section>
                <section>Perl 6 on BrickPi3. use NativeCall. https://docs.perl6.org/language/nativecall</section>
			</div>
		</div>

        <div class="credits">
            <div class="credit dragonlance" data-img="images/dragonlance_chronicles_legends.jpg">Photo: Tiago Farrajota | www.flickr.com/photos/nabo | BY-NC-SA-2.0</div>
            <div class="credit ev3visualloop" data-img="images/ev3visualloop.png">Photo: Klaus-Dieter Keller | commons.wikimedia.org/wiki/File:Entfernungsmesser.png | BY-NC-4.0</div>
            <div class="credit ev3brick" data-img="images/ev3brick.png">Photo: Vetalru | commons.wikimedia.org/wiki/File:Lego-mindstorms-ev3.jpg | BY-SA-3.0</div>
            <div class="credit langsev3dev" data-img="images/Programming_Languages_on_ev3dev.png">Captured from www.ev3dev.org/docs/programming-languages</div>
        </div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
                history: true,
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				]
			});
		</script>
	</body>
</html>
